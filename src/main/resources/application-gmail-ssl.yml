# ========================================
# GMAIL SSL CONFIGURATION (Port 465)
# ========================================
# This is an alternative configuration for Gmail using port 465 with full SSL
# instead of port 587 with STARTTLS.
#
# Use this profile if you're having issues with port 587:
#   mvn spring-boot:run -Dspring-boot.run.profiles=gmail-ssl
#
# Or set environment variable:
#   SPRING_PROFILES_ACTIVE=gmail-ssl

spring:
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:465}
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:your-app-password-here}
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true              # Enable full SSL/TLS
            protocols: TLSv1.2 TLSv1.3
            trust: ${MAIL_HOST:smtp.gmail.com}
          starttls:
            enable: false             # Disable STARTTLS (not needed with full SSL)
            required: false
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
        transport:
          protocol: smtp
        debug: ${MAIL_DEBUG:true}

email:
  from: ${EMAIL_FROM:noreply@license-service.com}
  enabled: ${EMAIL_ENABLED:true}

# ========================================
# HOW TO USE THIS CONFIGURATION
# ========================================
#
# 1. Set environment variables with your Gmail App Password:
#    MAIL_USERNAME=your-email@gmail.com
#    MAIL_PASSWORD=your-16-char-app-password (no spaces)
#
# 2. Run with this profile:
#    mvn spring-boot:run -Dspring-boot.run.profiles=gmail-ssl
#
# 3. Or activate via environment variable:
#    export SPRING_PROFILES_ACTIVE=gmail-ssl
#    mvn spring-boot:run
#
# ========================================
# DIFFERENCE FROM PORT 587
# ========================================
#
# Port 587 (STARTTLS):
#   - Starts unencrypted
#   - Upgrades to TLS via STARTTLS command
#   - More flexible but can have compatibility issues
#
# Port 465 (SSL):
#   - Encrypted from the start
#   - Full SSL/TLS connection
#   - More straightforward, may work better with some firewalls
#
# ========================================
# TROUBLESHOOTING
# ========================================
#
# If this still doesn't work:
# 1. Verify App Password is correct (16 characters, no spaces)
# 2. Check firewall allows port 465 outbound
# 3. Enable debug logging (mail.debug: true)
# 4. Check logs for detailed SMTP conversation
# 5. Test connectivity: telnet smtp.gmail.com 465
#
